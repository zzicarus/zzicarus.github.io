**数据包**
- [ ] 
**服务端**
- [x] **序号如何去重复使用** ✅ 2024-10-21
	- [x] 两边主动发送的序号是否需要同步？应该可以把不同类型的序号分开，服务端客户端各自自己的序号从 1 - 255 考虑，检查应答是否正确可以从序号和 Packet.type 判断 ✅ 2024-10-21
- [ ] UDP version
      a) 针对 UDP 模式，需要定义特殊类型的请求和响应，用于建立连接和释放连接。服务端检测该客户端是否处于已连接状态，如果未连接时收到除了连接/释放连接请求之外的其他请求，则发回未连接的错误响应。重复收到连接/释放连接请求时，根据当前连接状态返回适合的响应。接收数据时调用recvfrom()，发送数据时调用sendto()。
- [ ] 服务端主动推送
	- [ ] 
	- [x] 其他客户端发送的消息  to test ✅ 2024-10-21
	- [x] 其他客户端上线、下线的消息。 ✅ 2024-10-21
		- [ ] UDP 连接时发送消息，保存信息
	- [ ] 气象预警信息，包括地震、台风等
	      提供人机交互界面，实现人工触发向所有在线的客户端推送气象预警消息的功能。气象预警信息包括地震和台风两类。地震信息包括地震时间、震中经纬度、震级。台风信息包括台风中心经纬度、级别、预计登录地点和时间。
	      解包可以从类别分别解需要的数据，其他数据不用管
- [ ] 接受客户端传输数据⏫ 
	- [x] 多线程处理多个客户端 ✅ 2024-10-17
	- [x] 向客户端传送所请求的区号对应的城市名称 ✅ 2024-10-17
	- [x] 向客户端传送服务端所请求的日期、城市的气象信息 ✅ 2024-10-17
	- [x] 向客户端传送当前连接的所有客户端信息 ✅ 2024-10-17
- [ ] 数据加载  不同的服务端实例可以有不同的配置数据，首次运行时加载
	- [x] 城市和区号的对照列表  初始时至少有20个城市 ✅ 2024-10-14
	- [x] 所有城市七天内的气象信息  至少有20个城市的七天内气象信息 ✅ 2024-10-14

	- [ ] 
**测试**

- 


**参考：**
- [微软官方文档 · Winsock 入门](https://learn.microsoft.com/zh-cn/windows/win32/winsock/getting-started-with-winsock)
- [Youtube视频 · C++ Network Programming](https://www.youtube.com/watch?v=gntyAFoZp-E)

Server 的端口由 code 指定，client 由 OS 分配

WinSocket 的操作是针对某个 socket 的

Socket act as pipe

**Server**

- Bind
  将 Socket 和 IP 和 Port 进行绑定
- Listening
  
**Client**
- Bind
- Connected

## 服务器

1. 初始化 Winsock。`WASStartup`
2. 创建套接字。 `socket`
3. 绑定套接字。`bind`
4. 侦听客户端的套接字。 `listen`
5. 接受来自客户端的连接。 `accept connect`
6. 接收和发送数据。 `recv send secvfrom sendto`
7. 断开连接。 `closesocket`

## 客户端

1. 初始化 Winsock。
2. 创建套接字。
3. 连接到该服务器。
4. 发送和接收数据。
5. 断开连接。